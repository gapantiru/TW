function formatTime(ts)
{
    var TIME_FORMAT = "%d.%m.%Y, %H:%M:%S";
    function pad(value) {
        return (value.toString().length < 2) ? '0' + value : value;
    }
    function fmt(date){
        return TIME_FORMAT.replace(/%([a-zA-Z])/g, function(_, fmtCode){
            switch(fmtCode)
            {
                case 'Y':
                    return date.getFullYear();
                case 'm':
                    return pad(date.getMonth() + 1);
                case 'd':
                    return pad(date.getDate());
                case 'H':
                    return pad(date.getHours());
                case 'M':
                    return pad(date.getMinutes());
                case 'S':    
                    return pad(date.getSeconds());
                default:
                    throw new Error("Unsupported format code: " + fmtCode);
            }
        });
    }
    var date = new Date(ts * 1000);
    var now = Math.ceil(new Date().getTime() / 1000);
    var delta = now - ts;
    var pat = "", s = "";
    if (delta > 0)
        pat = "ago";
    else
        pat = "in";
    delta = Math.abs(delta)
    if (delta < 60)
        s = delta + " s";
    else if (delta < 3600)
        s = (delta / 60) + " min"
    else if (delta < 24*3600)
        s = (delta / 3600.).toFixed(1) + " h"
    else if (delta < 7*24*3600)
        s = (delta / (24. * 3600)).toFixed(1) + " days"
    else if (delta < 28*24*3600)
        s = (delta / (7. * 24 * 3600)).toFixed(1) + " weeks"
    else if (delta < 365*24*3600)
        s = (delta / (4 * 7. * 24 * 3600)).toFixed(1) + " months"
    else
        s = (delta / (365. * 24 * 3600)).toFixed(1) + " years"
    if (pat == "ago")
        pat = s + " " + pat
    else
        pat = pat + " " + s
    return fmt(date) + " (" + pat + ")";
}

ws = WScript.CreateObject('WScript.Shell');

ws.Popup(formatTime(new Date().getTime()));

WScript.Quit();